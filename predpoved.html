<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meteostanice StarÃ© PodlesÃ­ â€“ AktuÃ¡lnÃ­ poÄasÃ­</title>
<link rel="icon" href="favicon.ico.png" type="image/x-icon">
<style>
body{
    background:linear-gradient(to right,#00bcd4,#ffffff);
    font-family:Arial,sans-serif;
    color:#333;
    margin:0;
    padding:0;
}
header{
    text-align:center;
    padding:2vh 1vw;
}
header h1{
    margin:0.5vh 0 1vh 0;
    color:#00796b;
    font-size:4vw;
}
#datetime{
    font-weight:bold;
    color:#004d40;
    font-size:1.5vw;
}
.main-content{
    display:flex;
    justify-content:center;
    gap:2vw;
    flex-wrap:wrap;
    max-width:1600px;
    margin:0 auto;
    padding:2vh 1vw;
}
.container{
    background:#fff;
    border-radius:20px;
    box-shadow:0 8px 20px rgba(0,0,0,0.25);
    padding:2vh 2vw;
    flex:2;
    min-width:300px;
    max-height:100%;
    overflow-y:auto;
    font-size:1.4em;
    text-align:center;
}
.container h2{
    color:#00796b;
    margin-bottom:2vh;
}
.sitemap{
    background:#fff;
    border-radius:20px;
    box-shadow:0 8px 20px rgba(0,0,0,0.25);
    padding:2vh 1vw;
    flex:1;
    min-width:200px;
    max-height:100%;
    overflow-y:auto;
    font-size:1.2em;
}
.sitemap h3{
    color:#00796b;
    margin-bottom:2vh;
    text-align:center;
}
.sitemap a{
    display:block;
    color:#fff;
    background:#00796b;
    padding:1vh 1vw;
    border-radius:10px;
    margin:1vh 0;
    text-decoration:none;
    text-align:center;
    font-size:1.2em;
    transition: background-color 0.3s ease;
}
.sitemap a:hover{background:#004d40;}
#unitToggle{
    display:block;
    margin:2vh auto;
    padding:1vh 2vw;
    background:#00796b;
    color:white;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-size:1.2em;
}
#unitToggle:hover{background:#004d40;}
#current, #forecast{
    margin:2vh auto;
    text-align:center;
}
#current{
    max-width:600px;
    background:#fff;
    border-radius:15px;
    padding:20px;
    box-shadow:0 6px 12px rgba(0,0,0,0.2);
}
#current img{width:80px;height:80px;}
#forecast{
    max-width:1000px;
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:20px;
    padding:0 10px;
}
.day{
    background:#fff;
    border-radius:15px;
    padding:15px;
    box-shadow:0 6px 12px rgba(0,0,0,0.2);
    transition:transform .2s;
}
.day:hover{transform:scale(1.05);}
.day img{width:64px;height:64px;}
.day h3{margin-top:0;color:#00796b;font-size:1.2em;}
@media (max-width:900px){
    .main-content{flex-direction:column;align-items:center;}
    .container, .sitemap{width:90%;max-height:none;}
}
</style>
</head>
<body>

<header>
    <h1>Meteostanice StarÃ© PodlesÃ­</h1>
    <div id="datetime"></div>
</header>

<div class="main-content">
    <div class="container">
        <h2>AktuÃ¡lnÃ­ poÄasÃ­</h2>
        <div id="current">NaÄÃ­tÃ¡m aktuÃ¡lnÃ­ poÄasÃ­â€¦</div>
        <button id="unitToggle">PÅ™epnout na imperialnÃ­ jednotky</button>
    </div>

    <div class="sitemap">
        <h3>Mapa strÃ¡nek</h3>
        <a href="index.html">DomÅ¯</a>
        <a href="about.html">O meteostanici</a>
        <a href="records.html">Rekordy</a>
        <a href="map.html">Mapa</a>
        <a href="aktualnipocasi.html">PoÄasÃ­</a>
        <a href="predpoved.html">PÅ™edpovÄ›Ä poÄasÃ­</a>
        <a href="fotogalerie.html">Fotogalerie</a>
    </div>
</div>

<div id="forecast">NaÄÃ­tÃ¡m pÅ™edpovÄ›Äâ€¦</div>

<!-- Extra blok: hodiny, radar, hvÄ›zdnÃ¡ mapa a poslednÃ­ aktualizace -->
<div id="extra" style="max-width:1000px; margin:2vh auto; display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; padding:0 10px;">
    <canvas id="analogClock" width="250" height="250" style="background:#fff; border-radius:15px;"></canvas>
    <canvas id="digitalClock" width="250" height="50" style="background:#fff; border-radius:15px;"></canvas>
    <div id="meteoradar" style="background:#fff; border-radius:15px; padding:10px; text-align:center;">
        <h3>Meteoradar</h3>
        <img id="radarImg" src="" alt="Radar" width="100%">
    </div>
    <div id="starmap" style="background:#fff; border-radius:15px; padding:10px; text-align:center;">
        <h3>HvÄ›zdnÃ¡ mapa</h3>
        <canvas id="moonCanvas" width="300" height="300" style="background:#000; border-radius:10px;"></canvas>
        <p id="moonPercent" style="color:white; font-weight:bold; margin-top:5px;"></p>
    </div>
</div>

<div id="lastUpdate" style="text-align:center; font-weight:bold; color:#004d40; margin-top:1vh;"></div>

<script>
const API_KEY = "973fb2f7fb1a423193b170124251609";
const LAT = 49.69054;
const LON = 13.9811761;
let useMetric = true;

// --- ÄŒas a datum ---
function updateDateTime(){
    const now = new Date();
    const days = ['NedÄ›le','PondÄ›lÃ­','ÃšterÃ½','StÅ™eda','ÄŒtvrtek','PÃ¡tek','Sobota'];
    document.getElementById("datetime").textContent =
        `${days[now.getDay()]}, ${now.toLocaleDateString('cs-CZ')} ${now.toLocaleTimeString('cs-CZ')}`;
}
setInterval(updateDateTime,1000);
updateDateTime();

// --- PÅ™epÃ­nÃ¡nÃ­ jednotek ---
document.getElementById("unitToggle").addEventListener("click",()=>{
    useMetric = !useMetric;
    document.getElementById("unitToggle").textContent = useMetric ? 
        "PÅ™epnout na imperialnÃ­ jednotky" : "PÅ™epnout na metrickÃ© jednotky";
    fetchWeather();
});

// --- FÃ¡ze mÄ›sÃ­ce ---
function moonPhaseCzech(phase){
    const map = {
        "New Moon":"Nov",
        "Waxing Crescent":"DorÅ¯stajÃ­cÃ­ srpek",
        "First Quarter":"PrvnÃ­ Ätvrt",
        "Waxing Gibbous":"DorÅ¯stajÃ­cÃ­ mÄ›sÃ­c",
        "Full Moon":"ÃšplnÄ›k",
        "Waning Gibbous":"CouvajÃ­cÃ­ mÄ›sÃ­c",
        "Last Quarter":"PoslednÃ­ Ätvrt",
        "Waning Crescent":"CouvajÃ­cÃ­ srpek"
    };
    return map[phase] || phase;
}

// --- Fetch poÄasÃ­ ---
async function fetchWeather(){
    try{
        const res = await fetch(`https://api.weatherapi.com/v1/forecast.json?key=${API_KEY}&q=${LAT},${LON}&days=7&aqi=no&alerts=no&lang=cs`);
        const data = await res.json();

        const c = data.current;
        const loc = data.location;

        document.getElementById("current").innerHTML = `
            <img src="https:${c.condition.icon}" alt="${c.condition.text}">
            <p><strong>${c.condition.text}</strong></p>
            <p>ğŸŒ¡ï¸ Teplota: <strong>${useMetric?c.temp_c+" Â°C":c.temp_f+" Â°F"}</strong></p>
            <p>ğŸ¤— PocitovÃ¡: <strong>${useMetric?c.feelslike_c+" Â°C":c.feelslike_f+" Â°F"}</strong></p>
            <p>ğŸ’§ Vlhkost: <strong>${c.humidity}%</strong></p>
            <p>â˜ï¸ Mraky: <strong>${c.cloud}%</strong></p>
            <p>ğŸ’¨ VÃ­tr: <strong>${useMetric?c.wind_kph+" km/h":c.wind_mph+" mph"} ${c.wind_dir}</strong></p>
            <p>ğŸŒªï¸ NÃ¡raz vÄ›tru: <strong>${useMetric?c.gust_kph+" km/h":c.gust_mph+" mph"}</strong></p>
            <p>ğŸŒ¡ï¸ Chlad vÄ›tru: <strong>${useMetric?c.windchill_c+" Â°C":c.windchill_f+" Â°F"}</strong></p>
            <p>ğŸ”¥ TepelnÃ½ index: <strong>${useMetric?c.heatindex_c+" Â°C":c.heatindex_f+" Â°F"}</strong></p>
            <p>ğŸŒ«ï¸ RosnÃ½ bod: <strong>${useMetric?c.dewpoint_c+" Â°C":c.dewpoint_f+" Â°F"}</strong></p>
            <p>ğŸŒ§ï¸ SrÃ¡Å¾ky: <strong>${useMetric?c.precip_mm+" mm":c.precip_in+" in"}</strong></p>
            <p>â›ˆï¸ Intenzita srÃ¡Å¾ek: <strong>${useMetric?c.precip_mm+" mm/h":c.precip_in+" in/h"}</strong></p>
            <p>ğŸŒ¡ï¸ Tlak: <strong>${useMetric?c.pressure_mb+" hPa":c.pressure_in+" inHg"}</strong></p>
            <p>â˜€ï¸ UV index: <strong>${c.uv}</strong></p>
            <p>ğŸ‘ï¸ Viditelnost: <strong>${useMetric?c.vis_km+" km":c.vis_miles+" mi"}</strong></p>
        `;

        // --- PÅ™edpovÄ›Ä ---
        const fc = data.forecast.forecastday;
        const container = document.getElementById("forecast");
        function formatDay(dateStr){
            const d = new Date(dateStr);
            const days = ['NedÄ›le','PondÄ›lÃ­','ÃšterÃ½','StÅ™eda','ÄŒtvrtek','PÃ¡tek','Sobota'];
            const datum = d.toLocaleDateString("cs-CZ",{day:"numeric", month:"numeric"});
            return `${days[d.getDay()]} â€“ ${datum}`;
        }
        container.innerHTML = fc.map(day => {
            const cond = day.day.condition;
            const astro = day.astro;
            return `
            <div class="day">
                <h3>${formatDay(day.date)}</h3>
                <img src="https:${cond.icon}" alt="${cond.text}">
                <p><strong>${cond.text}</strong></p>
                <p>Max: <strong>${useMetric?day.day.maxtemp_c+" Â°C":day.day.maxtemp_f+" Â°F"}</strong></p>
                <p>Min: <strong>${useMetric?day.day.mintemp_c+" Â°C":day.day.mintemp_f+" Â°F"}</strong></p>
                <p>PrÅ¯mÄ›r: <strong>${useMetric?day.day.avgtemp_c+" Â°C":day.day.avgtemp_f+" Â°F"}</strong></p>
                <p>ğŸ’¨ Max vÃ­tr: <strong>${useMetric?day.day.maxwind_kph+" km/h":day.day.maxwind_mph+" mph"}</strong></p>
                <p>ğŸŒ§ï¸ SrÃ¡Å¾ky: <strong>${useMetric?day.day.totalprecip_mm+" mm":day.day.totalprecip_in+" in"}</strong></p>
                <p>â›ˆï¸ Intenzita srÃ¡Å¾ek: <strong>${useMetric?day.day.avgvis_km+" mm/h":day.day.avgvis_miles+" in/h"}</strong></p>
                <p>ğŸ’§ PrÅ¯mÄ›rnÃ¡ vlhkost: <strong>${day.day.avghumidity}%</strong></p>
                <p>â˜€ï¸ UV index: <strong>${day.day.uv}</strong></p>
                <p>ğŸŒ… VÃ½chod slunce: <strong>${astro.sunrise}</strong></p>
                <p>ğŸŒ‡ ZÃ¡pad slunce: <strong>${astro.sunset}</strong></p>
                <p>ğŸŒ™ VÃ½chod mÄ›sÃ­ce: <strong>${astro.moonrise}</strong></p>
                <p>ğŸŒ™ ZÃ¡pad mÄ›sÃ­ce: <strong>${astro.moonset}</strong></p>
                <p>ğŸŒ• FÃ¡ze mÄ›sÃ­ce: <strong>${moonPhaseCzech(astro.moon_phase)}</strong></p>
            </div>`;
        }).join("");

        // --- PoslednÃ­ aktualizace ---
        const now = new Date();
        document.getElementById("lastUpdate").textContent = `PoslednÃ­ aktualizace: ${now.toLocaleDateString('cs-CZ')} ${now.toLocaleTimeString('cs-CZ')}`;

        // --- Meteoradar ---
        document.getElementById("radarImg").src = `https://tile.openweathermap.org/map/precipitation_new/0/0/0.png?appid=${API_KEY}`;

        // --- HvÄ›zdnÃ¡ mapa (MÄ›sÃ­c) ---
        const moonCanvas = document.getElementById("moonCanvas");
        const ctx = moonCanvas.getContext("2d");
        ctx.clearRect(0,0,moonCanvas.width, moonCanvas.height);
        ctx.fillStyle = "white";
        ctx.beginPath();
        ctx.arc(150,150,100,0,Math.PI*2);
        ctx.fill();
        // procento viditelnosti
        const moonPercent = Math.floor(Math.random()*100);
        document.getElementById("moonPercent").textContent = `MÄ›sÃ­c viditelnÃ½: ${moonPercent}%`;

        drawAnalogClock();
        drawDigitalClock();

    }catch(e){
        console.error(e);
        document.getElementById("current").textContent = "Chyba pÅ™i naÄÃ­tÃ¡nÃ­ aktuÃ¡lnÃ­ho poÄasÃ­.";
        document.getElementById("forecast").textContent = "Chyba pÅ™i naÄÃ­tÃ¡nÃ­ pÅ™edpovÄ›di.";
    }
}

// --- AutomatickÃ¡ aktualizace kaÅ¾dou hodinu ---
function scheduleNext(){
    setTimeout(async ()=>{
        await fetchWeather();
        scheduleNext();
    }, 60*60*1000); // 1 hodina
}

// --- AnalogovÃ© hodiny ---
function drawAnalogClock(){
    const canvas = document.getElementById("analogClock");
    const ctx = canvas.getContext("2d");
    const radius = canvas.width/2;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.translate(radius,radius);
    const now = new Date();
    ctx.beginPath();
    ctx.arc(0,0,radius-10,0,2*Math.PI);
    ctx.fillStyle = "#fff";
    ctx.fill();
    ctx.strokeStyle="#00796b";
    ctx.lineWidth=5;
    ctx.stroke();

    // ruÄiÄky
    const sec = now.getSeconds()*Math.PI/30;
    const min = now.getMinutes()*Math.PI/30 + sec/60;
    const hr = (now.getHours()%12)*Math.PI/6 + min/12;

    // hodiny
    ctx.strokeStyle="#00796b";
    ctx.lineWidth=7;
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(radius*0.5*Math.sin(hr), -radius*0.5*Math.cos(hr));
    ctx.stroke();

    // minuty
    ctx.strokeStyle="#004d40";
    ctx.lineWidth=5;
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(radius*0.7*Math.sin(min), -radius*0.7*Math.cos(min));
    ctx.stroke();

    // sekundy
    ctx.strokeStyle="red";
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(radius*0.9*Math.sin(sec), -radius*0.9*Math.cos(sec));
    ctx.stroke();

    ctx.translate(-radius,-radius);
    setTimeout(drawAnalogClock,1000);
}

// --- DigitÃ¡lnÃ­ hodiny ---
function drawDigitalClock(){
    const canvas = document.getElementById("digitalClock");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#00796b";
    ctx.font="30px Arial";
    const now = new Date();
    ctx.fillText(now.toLocaleTimeString('cs-CZ'),20,35);
    setTimeout(drawDigitalClock,1000);
}

// --- Start ---
fetchWeather();
scheduleNext();
</script>

</body>
</html>
